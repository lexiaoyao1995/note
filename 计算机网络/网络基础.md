  * [osi七层模型](#osi%E4%B8%83%E5%B1%82%E6%A8%A1%E5%9E%8B)
  * [TCP/IP概念层](#tcpip%E6%A6%82%E5%BF%B5%E5%B1%82)
  * [在浏览器地址栏键入url后，按下回车后经历的流程](#%E5%9C%A8%E6%B5%8F%E8%A7%88%E5%99%A8%E5%9C%B0%E5%9D%80%E6%A0%8F%E9%94%AE%E5%85%A5url%E5%90%8E%E6%8C%89%E4%B8%8B%E5%9B%9E%E8%BD%A6%E5%90%8E%E7%BB%8F%E5%8E%86%E7%9A%84%E6%B5%81%E7%A8%8B)
* [网络一致性](#%E7%BD%91%E7%BB%9C%E4%B8%80%E8%87%B4%E6%80%A7)
  * [拜占庭将军问题](#%E6%8B%9C%E5%8D%A0%E5%BA%AD%E5%B0%86%E5%86%9B%E9%97%AE%E9%A2%98)
  * [Raft协议](#raft%E5%8D%8F%E8%AE%AE)
      * [选取主节点](#%E9%80%89%E5%8F%96%E4%B8%BB%E8%8A%82%E7%82%B9)
      * [同步数据](#%E5%90%8C%E6%AD%A5%E6%95%B0%E6%8D%AE)
* [DNS](#dns)
  * [DNS过程](#dns%E8%BF%87%E7%A8%8B)

## osi七层模型

1、物理层   比特流

2、数据链路层  帧结构  交换机

3、网络层   路由器  ip协议  分组

4、传输层   tcp   udp   分段

5、会话层   不同机器上的户用建立会话    数据

6、表示层   信息的语法

7、应用层    http 

## TCP/IP概念层

1、链路层

2、网络层

3、传输层

4、应用层

## 在浏览器地址栏键入url后，按下回车后经历的流程

1、dns解析

2、tcp连接

3、发送http请求

4、服务器处理请求并返回http报文

5、浏览器解析渲染页面

6、连接结束

# 网络一致性

## 拜占庭将军问题

在打仗的时候，拜占庭军队内所有将军必需达成**一致的共识**，才能更好地赢得胜利。但是，在军队内有可能存有叛徒，扰乱将军们的决定。

这时候，在已知有成员不可靠的情况下，其余忠诚的将军需要在不受叛徒或间谍的影响下达成一致的协议。

莱斯利·兰伯特（ Leslie Lamport ）通过这个比喻，表达了计算机网络中所存在的一致性问题。这个问题被称为**拜占庭将军问题**。

## Raft协议

Raft 算法是一种简单易懂的共识算法。它依靠 **状态机** 和 **主从同步** 的方式，在各个节点之间实现数据的一致性。

在学习Raft算法的时候，大家需要了解Raft的两个核心要点：

**1.选取主节点**

**2.同步数据**

#### 选取主节点

Raft算法为节点定义了三种角色：

**1.Leader**（主节点）

**2.Follower**（从节点）

**3.Candidate**（参与投票竞争的节点）

让我们来看一看选主的具体流程：

**第一步**，在最初，还没有一个主节点的时候，所有节点的身份都是Follower。每一个节点都有自己的计时器，当计时达到了超时时间（Election Timeout），该节点会转变为Candidate。

**第二步**，成为Candidate的节点，会首先给自己投票，然后向集群中其他所有的节点发起请求，要求大家都给自己投票。

**第三步**，其他收到投票请求且还未投票的Follower节点会向发起者投票，发起者收到反馈通知后，票数增加。

**第四步**，当得票数超过了集群节点数量的一半，该节点晋升为Leader节点。Leader节点会立刻向其他节点发出通知，告诉大家自己才是老大。收到通知的节点全部变为Follower，并且各自的计时器清零。

每个节点的超时时间都是不一样的。比如A节点的超时时间是3秒，B节点的超时时间是5秒，C节点的超时时间是4秒。这样一来，A节点将会最先发起投票请求，而不是所有节点同时发起。

为什么这样设计呢？设想如果所有节点同时发起投票，必然会导致大家的票数差不多，形成僵局，谁也当不成老大。

那么，成为Leader的节点是否就坐稳了老大的位置呢？并不是。Leader节点需要每隔一段时间向集群其他节点发送心跳通知，表明你们的老大还活着。

#### 同步数据

**第一步**，由客户端提交数据到Leader节点。

**第二步**，由Leader节点把数据复制到集群内所有的Follower节点。如果一次复制失败，会不断进行重试。

**第三步**，Follower节点们接收到复制的数据，会反馈给Leader节点。

**第四步**，如果Leader节点接收到超过半数的Follower反馈，表明复制成功。于是提交自己的数据，并通知客户端数据提交成功。

**第五步**，由Leader节点通知集群内所有的Follower节点提交数据，从而完成数据同步流程。

# DNS

DNS是应用层协议，事实上他是为其他应用层协议工作的，包括不限于HTTP和SMTP以及FTP，用于将用户提供的主机名解析为ip地址。

## DNS过程

关于DNS的获取流程：
DNS是应用层协议，事实上他是为其他应用层协议工作的，包括不限于HTTP和SMTP以及FTP，用于将用户提供的主机名解析为ip地址。
具体过程如下：
①用户主机上运行着DNS的客户端，就是我们的PC机或者手机客户端运行着DNS客户端了
②浏览器将接收到的url中抽取出域名字段，就是访问的主机名，比如

```text
http://www.baidu.com/
```

, 并将这个主机名传送给DNS应用的客户端
③DNS客户机端向DNS服务器端发送一份查询报文，报文中包含着要访问的主机名字段（中间包括一些列缓存查询以及分布式DNS集群的工作）
④该DNS客户机最终会收到一份回答报文，其中包含有该主机名对应的IP地址
⑤一旦该浏览器收到来自DNS的IP地址，就可以向该IP地址定位的HTTP服务器发起TCP连接

